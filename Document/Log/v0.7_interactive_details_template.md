# Version 0.7 Development Log - Interactive Details Template

## 开发时间
2026-02-15

## 版本目标
新增 `interactive-details` 模板——深色主题的交互式详情展示模板。

## 需求描述
- 基于 innovation（`text-image-left`）的布局风格，左侧文本列表 + 右侧内容区
- 深色主题（`bg-black`）
- 左侧为可点击的条目列表，每个条目有 `title` 和 `description`
- 点击某个条目后：左侧展开对应 `description`，右侧以苹果风格翻转动画切换到对应 `detail` 内容
- 右侧 detail 区域支持 Markdown 富文本渲染

## 实现方案

### 1. 模板函数 (`js/templates.js`)

**新增函数**: `interactiveDetailsTemplate(sectionId, data, material)`

**数据结构**:
```json
{
  "headline": "标题（可选）",
  "items": [
    {
      "title": "条目标题",
      "description": "简短描述（左侧展开）",
      "detail": "完整详情（右侧显示，支持 Markdown）"
    }
  ]
}
```

**布局**:
- 沿用 innovation 的比例：左侧 `w-[500px]` + 右侧 `flex-1`
- 间距 `gap-[80px]`，容器 `max-w-[1440px] px-[120px]`

**左侧列表**:
- `.id-item` 元素，支持 `active` 状态
- 选中项标题为白色，未选中为 `white/40`
- 选中项左侧有渐变蓝色竖线指示器（`::before` 伪元素）
- `description` 通过 `max-height` + `opacity` 动画展开/收起
- Lucide 图标：选中 `chevron-down`，未选中 `plus`

**右侧详情面板**:
- `.id-detail-panel` 绝对定位堆叠，同时只有一个 `--active`
- 容器使用微妙的玻璃质感：`bg-white/[0.04] border border-white/[0.08]`
- 内容包含标题、蓝色分割线、Markdown 富文本
- 支持 LaTeX 渲染（切换后自动调用 `LatexRenderer.renderAll()`）

### 2. CSS 动画 (`css/styles.css`)

**翻转动画**:
- `@keyframes idFlipOut`：`rotateY(0deg) → rotateY(90deg)`，同时 `scale(0.95)` 收缩
- `@keyframes idFlipIn`：`rotateY(-90deg) → rotateY(0deg)`，同时恢复 `scale(1)`
- 每段动画持续 `0.35s`，使用不同的缓动曲线
  - flip-out: `cubic-bezier(0.4, 0, 0.6, 1)` 加速离开
  - flip-in: `cubic-bezier(0, 0, 0.2, 1)` 减速进入
- 总切换时间约 `0.7s`，体感流畅

**描述展开/收起**:
- `.id-item-desc`：默认 `max-height: 0; opacity: 0`
- `.id-item-desc--open`：`max-height: 200px; opacity: 1`
- 过渡使用 `cubic-bezier(0.4, 0, 0.2, 1)` 曲线，时长 `0.5s`

**容器微光效果**:
- `.id-detail-container:hover` 添加微妙的蓝色/青色 `box-shadow`
- 自定义滚动条样式，与深色主题匹配

### 3. 交互逻辑 (`js/section-renderer.js`)

**新增函数**: `initializeInteractiveDetails()`

**工作流程**:
1. 查找所有 `[data-id-list]` 容器
2. 为每个 `.id-item` 绑定 click 事件
3. 点击时：
   - 防止重复点击（`isAnimating` 锁）
   - 收起所有条目描述，展开目标条目
   - 当前右侧面板添加 `id-detail-panel--flip-out` 类
   - `animationend` 后移除，给目标面板添加 `id-detail-panel--flip-in`
   - 第二次 `animationend` 后标记为 `--active`，解锁
4. 在 `reinitializeComponents()` 中调用，确保动态渲染后也能正常工作

### 4. 模板画廊 (`js/editor.js`)

**SVG 预览图**:
- 深色背景 (`#0a0a0a`)
- 左侧：列表条目示意（白色高亮第一项 + 灰色其余项 + 分隔线）
- 右侧：圆角卡片内的文本内容示意
- 蓝色竖线指示器强调选中状态

### 5. 模板注册

在 `templates` 注册表中添加：
```javascript
'interactive-details': interactiveDetailsTemplate
```

## 涉及文件
| 文件 | 修改内容 |
|------|---------|
| `js/templates.js` | 新增 `interactiveDetailsTemplate` 函数 + 注册 |
| `css/styles.css` | 新增 `.id-*` 系列样式和 `@keyframes` 动画 |
| `js/section-renderer.js` | 新增 `initializeInteractiveDetails()` + 调用 |
| `js/editor.js` | 新增模板 SVG 预览图 |
| `docs/js/templates.js` | 同步 |
| `Example/js/templates.js` | 同步 |

## 使用方式

在 `material.json` 中配置一个使用此模板的 section：

```json
{
  "config": {
    "sections": [
      {
        "id": "myDetails",
        "template": "interactive-details",
        "enabled": true,
        "order": 6,
        "name": "My Details"
      }
    ]
  },
  "index": {
    "myDetails": {
      "headline": "Explore The Details.",
      "items": [
        {
          "title": "First Topic",
          "description": "A brief overview of the first topic.",
          "detail": "Full detailed content supporting **Markdown** and LaTeX formulas."
        },
        {
          "title": "Second Topic",
          "description": "A brief overview of the second topic.",
          "detail": "Another detailed section with rich content."
        }
      ]
    }
  }
}
```

## 与现有模板的关系
- **布局基准**: 继承自 `text-image-left`（innovation）的左右分栏布局和深色主题
- **交互灵感**: 类似 `accordion` 的左侧列表切换，但右侧不是固定图片而是可翻转的详情面板
- **动画体系**: 独立的 `idFlipOut/idFlipIn` 动画，不复用 flip-card 系统（因为切换逻辑不同）

## 视觉优化 (2026-02-15 晚)

### 问题
初版配色"黑不溜秋太丑"，不符合网站整体 Apple 风格。

### 优化方案

**1. 右侧容器**：
- 改用 `bg-surface-dark`（`#1c1c1e`）替代 `white/[0.04]`
- 添加 `shadow-2xl shadow-black/40` 阴影，营造深度和质感
- hover 时添加蓝色/青色微光：`box-shadow: 0 0 80px rgba(0,113,227,0.08)`

**2. 左侧列表**：
- 标题字号从 `22px` → `28px`，更符合 Apple 大字号风格
- 选中项文本从 `text-white/40` → `text-white/50`（未选中），增强可读性
- 图标从 `plus`/`chevron-down` → 统一用 `chevron-right`/`chevron-down`，更简洁
- description 字号从 `15px` → `17px`，`max-height` 从 `200px` → `300px`

**3. 指示条**：
- 宽度从 `3px` → `4px`
- 高度从 `40%` → `50%`
- 添加蓝色微光 `box-shadow: 0 0 12px rgba(34,211,238,0.4)`
- hover 未选中项时也显示半透明指示条（`opacity: 0.3`, `height: 30%`）

**4. 右侧面板内容**：
- 标题字号从 `32px` → `48px`
- 分割线从纯蓝色 → 渐变（`from-accent-blue to-accent-cyan`），高度 `2px` → `3px`，圆角 `rounded-full`
- 正文字号从 `16px` → `19px`，行高 `1.6`，颜色从 `white/70` → `white/80`
- padding 从 `48px` → `60px`

**5. 动画**：
- 时长从 `0.35s` → `0.4s`，更从容优雅
- scale 从 `0.95` → `0.96`，更微妙

**6. 滚动条**：
- 宽度从 `4px` → `6px`
- 颜色从 `white/15` → `white/20`，hover `white/30`

**配色遵循**：
- 主背景：`#000000` (black)
- 卡片背景：`#1c1c1e` (surface-dark)
- 渐变强调：`#0071E3` (accent-blue) → `#22D3EE` (accent-cyan)
- 文本层级：白色（100% / 80% / 60% / 50% / 30%）

与 `innovation` 和 `safety` 等深色 section 保持一致，整体风格更接近 Apple 官网。
